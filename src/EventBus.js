/**
 * EventBus.js
 * –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –®–∏–Ω—ã –°–æ–±—ã—Ç–∏–π (Event Bus) –Ω–∞ –±–∞–∑–µ EventEmitter –∏–∑ 'events'.
 * –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —É–∑–µ–ª –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ –Ø–¥—Ä–∞ –∏ UI.
 */
const EventEmitter = require("events");

class EventBus extends EventEmitter {
  constructor() {
    super();
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–∏–º–∏—Ç–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π –≤ 0 (–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ) –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
    this.setMaxListeners(0);
  }

  /**
   * –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏–µ. –ê–ª–∏–∞—Å –¥–ª—è on().
   * @param {string} eventName - –ò–º—è —Å–æ–±—ã—Ç–∏—è.
   * @param {function} handler - –§—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫.
   */
  subscribe(eventName, handler) {
    this.on(eventName, handler);
  }

  /**
   * –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º. –ê–ª–∏–∞—Å –¥–ª—è emit().
   * @param {string} eventName - –ò–º—è —Å–æ–±—ã—Ç–∏—è.
   * @param {any} data - –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏.
   */
  publish(eventName, data) {
    this.emit(eventName, data);
    // console.log(`[BUS] üì¢ –°–æ–±—ã—Ç–∏–µ: ${eventName} –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ.`); // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
  }
}

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –®–∏–Ω—ã –°–æ–±—ã—Ç–∏–π (Singleton)
module.exports = new EventBus();
